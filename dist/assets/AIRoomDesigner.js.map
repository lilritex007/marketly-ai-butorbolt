{"version":3,"file":"AIRoomDesigner.js","sources":["../../node_modules/lucide-react/dist/esm/icons/rotate-ccw.js","../../node_modules/lucide-react/dist/esm/icons/upload.js","../../src/components/ai/AIRoomDesigner.jsx"],"sourcesContent":["/**\n * @license lucide-react v0.456.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst RotateCcw = createLucideIcon(\"RotateCcw\", [\n  [\"path\", { d: \"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8\", key: \"1357e3\" }],\n  [\"path\", { d: \"M3 3v5h5\", key: \"1xhq8a\" }]\n]);\n\nexport { RotateCcw as default };\n//# sourceMappingURL=rotate-ccw.js.map\n","/**\n * @license lucide-react v0.456.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Upload = createLucideIcon(\"Upload\", [\n  [\"path\", { d: \"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\", key: \"ih7n3h\" }],\n  [\"polyline\", { points: \"17 8 12 3 7 8\", key: \"t8dd8p\" }],\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"3\", y2: \"15\", key: \"widbto\" }]\n]);\n\nexport { Upload as default };\n//# sourceMappingURL=upload.js.map\n","import React, { useState, useRef, useMemo } from 'react';\nimport { Camera, Upload, Loader2, Sparkles, CheckCircle, X, AlertCircle, RotateCcw, ShoppingBag, Lightbulb, Star } from 'lucide-react';\nimport { analyzeImage } from '../../services/geminiService';\nimport { trackProductView } from '../../services/userPreferencesService';\n\n/**\n * AIRoomDesigner - Szoba elemz√©s Gemini Vision AI-val\n * Teljes adatb√°zis ismeret√©vel szem√©lyre szabott aj√°nl√°sok\n */\nconst AIRoomDesigner = ({ products, onProductRecommendations, onClose }) => {\n  const [selectedImage, setSelectedImage] = useState(null);\n  const [imagePreview, setImagePreview] = useState(null);\n  const [isAnalyzing, setIsAnalyzing] = useState(false);\n  const [analysis, setAnalysis] = useState(null);\n  const [analysisError, setAnalysisError] = useState(null);\n  const [recommendations, setRecommendations] = useState([]);\n  const [aiKeywords, setAiKeywords] = useState([]);\n  const fileInputRef = useRef(null);\n\n  // Term√©k statisztik√°k az AI sz√°m√°ra\n  const productStats = useMemo(() => {\n    if (!products?.length) return null;\n    \n    const categories = {};\n    products.forEach(p => {\n      const cat = (p.category || 'Egy√©b').split(' > ')[0];\n      categories[cat] = (categories[cat] || 0) + 1;\n    });\n    \n    const topCategories = Object.entries(categories)\n      .sort((a, b) => b[1] - a[1])\n      .slice(0, 8)\n      .map(([name]) => name);\n    \n    return { total: products.length, topCategories };\n  }, [products]);\n\n  const handleImageSelect = (e) => {\n    const file = e.target.files?.[0];\n    if (file && file.type.startsWith('image/')) {\n      if (file.size > 4 * 1024 * 1024) {\n        setAnalysisError('A k√©p t√∫l nagy! Maximum 4MB enged√©lyezett.');\n        return;\n      }\n      \n      setSelectedImage(file);\n      setAnalysisError(null);\n      setAnalysis(null);\n      setRecommendations([]);\n      setAiKeywords([]);\n      \n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setImagePreview(reader.result);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n\n  const analyzeRoom = async () => {\n    if (!selectedImage || !imagePreview) return;\n\n    setIsAnalyzing(true);\n    setAnalysis(null);\n    setAnalysisError(null);\n    setRecommendations([]);\n    setAiKeywords([]);\n\n    try {\n      const base64Image = imagePreview.split(',')[1];\n      const mimeType = selectedImage.type || 'image/jpeg';\n\n      // R√©szletes prompt a jobb elemz√©shez\n      const prompt = `Elemezd r√©szletesen ezt a szobafot√≥t √©s adj b√∫tor aj√°nl√°sokat!\n\nELEMEZD:\n1. Szoba t√≠pusa (nappali, h√°l√≥szoba, √©tkez≈ë, iroda, stb.)\n2. Jelenlegi st√≠lus (modern, skandin√°v, klasszikus, minimalista, stb.)\n3. Domin√°ns sz√≠nek\n4. Milyen b√∫torok hi√°nyoznak vagy cser√©lend≈ëk\n\nV√ÅLASZOD FORM√ÅTUMA (pontosan ezt k√∂vesd!):\nSZOBA: [szoba t√≠pusa]\nST√çLUS: [st√≠lus neve]\nSZ√çNEK: [2-3 sz√≠n]\nAJ√ÅNLOTT_B√öTOROK: [b√∫tor1], [b√∫tor2], [b√∫tor3], [b√∫tor4]\nTIPP: [1 mondat szem√©lyre szabott tan√°cs magyarul, tegezve]`;\n\n      const result = await analyzeImage(base64Image, mimeType, prompt);\n\n      if (result.success && result.text) {\n        // Struktur√°lt v√°lasz feldolgoz√°sa\n        const responseText = result.text;\n        \n        // Kulcsszavak kinyer√©se\n        const keywords = [];\n        \n        const roomMatch = responseText.match(/SZOBA:\\s*(.+)/i);\n        const styleMatch = responseText.match(/ST√çLUS:\\s*(.+)/i);\n        const colorsMatch = responseText.match(/SZ√çNEK:\\s*(.+)/i);\n        const furnitureMatch = responseText.match(/AJ√ÅNLOTT_B√öTOROK:\\s*(.+)/i);\n        const tippMatch = responseText.match(/TIPP:\\s*(.+)/i);\n        \n        if (roomMatch) keywords.push(...roomMatch[1].toLowerCase().split(/[,\\s]+/).filter(k => k.length > 2));\n        if (styleMatch) keywords.push(...styleMatch[1].toLowerCase().split(/[,\\s]+/).filter(k => k.length > 2));\n        if (colorsMatch) keywords.push(...colorsMatch[1].toLowerCase().split(/[,\\s]+/).filter(k => k.length > 2));\n        if (furnitureMatch) keywords.push(...furnitureMatch[1].toLowerCase().split(/[,\\s]+/).filter(k => k.length > 2));\n        \n        setAiKeywords(keywords);\n        \n        // Olvashat√≥ elemz√©s √∂ssze√°ll√≠t√°sa\n        let readableAnalysis = '';\n        if (roomMatch) readableAnalysis += `üìç **Szoba:** ${roomMatch[1].trim()}\\n`;\n        if (styleMatch) readableAnalysis += `üé® **St√≠lus:** ${styleMatch[1].trim()}\\n`;\n        if (colorsMatch) readableAnalysis += `üéØ **Sz√≠nvil√°g:** ${colorsMatch[1].trim()}\\n`;\n        if (furnitureMatch) readableAnalysis += `üõãÔ∏è **Aj√°nlott b√∫torok:** ${furnitureMatch[1].trim()}\\n`;\n        if (tippMatch) readableAnalysis += `\\nüí° ${tippMatch[1].trim()}`;\n        \n        // Ha nem siker√ºlt struktur√°lni, haszn√°ljuk az eredeti v√°laszt\n        if (!readableAnalysis) {\n          readableAnalysis = responseText;\n        }\n        \n        setAnalysis(readableAnalysis);\n        \n        // Term√©k aj√°nl√°sok keres√©se\n        const matchedProducts = findMatchingProductsAdvanced(keywords, furnitureMatch?.[1] || '');\n        setRecommendations(matchedProducts);\n        \n        if (onProductRecommendations && matchedProducts.length > 0) {\n          onProductRecommendations(matchedProducts);\n        }\n      } else {\n        setAnalysisError(result.error || 'Nem siker√ºlt elemezni a k√©pet.');\n      }\n\n    } catch (error) {\n      console.error('K√©pelemz√©s hiba:', error);\n      setAnalysisError('V√°ratlan hiba t√∂rt√©nt. Pr√≥b√°lj m√°sik k√©pet!');\n    } finally {\n      setIsAnalyzing(false);\n    }\n  };\n\n  // Fejlett term√©k keres√©s AI kulcsszavak alapj√°n\n  const findMatchingProductsAdvanced = (keywords, furnitureText) => {\n    if (!products || products.length === 0) return [];\n    \n    // B√∫tor t√≠pus szinonim√°k\n    const furnitureSynonyms = {\n      'kanap√©': ['kanap√©', '√ºl≈ëgarnit√∫ra', 'sofa', 'sz√≥fa', 'sarok√ºl≈ë', 'hever≈ë'],\n      'fotel': ['fotel', 'karossz√©k', 'pihen≈ëfotel', 'relax fotel'],\n      'asztal': ['asztal', 'doh√°nyz√≥asztal', '√©tkez≈ëasztal', '√≠r√≥asztal', 'konzolasztal'],\n      'sz√©k': ['sz√©k', '√©tkez≈ësz√©k', 'forg√≥sz√©k', 'irodai sz√©k'],\n      '√°gy': ['√°gy', 'francia√°gy', 'boxspring', 'h√°l√≥szoba'],\n      'szekr√©ny': ['szekr√©ny', 'gardr√≥b', 'kom√≥d', 't√°lal√≥', 'vitrin'],\n      'polc': ['polc', 'k√∂nyvespolc', 'falipolc', '√°llv√°ny'],\n      'l√°mpa': ['l√°mpa', 'vil√°g√≠t√°s', '√°ll√≥l√°mpa', 'asztali l√°mpa'],\n    };\n\n    // St√≠lus kulcsszavak\n    const styleKeywords = {\n      'modern': ['modern', 'minimalista', 'kort√°rs', 'letisztult', 'egyszer≈±'],\n      'skandin√°v': ['skandin√°v', 'nordic', 'nat√∫r', 'vil√°gos', 'feh√©r', 'fa'],\n      'klasszikus': ['klasszikus', 'eleg√°ns', 'tradicion√°lis', 'id≈ëtlen'],\n      'indusztri√°lis': ['indusztri√°lis', 'loft', 'ipari', 'f√©m', 'vas'],\n      'vintage': ['vintage', 'retro', 'antik', 'r√©gi'],\n    };\n\n    // Sz√≠n kulcsszavak\n    const colorKeywords = ['feh√©r', 'fekete', 'sz√ºrke', 'barna', 'b√©zs', 'k√©k', 'z√∂ld', 'piros', 'nat√∫r', 'fa', 'di√≥', 't√∂lgy'];\n\n    // √ñsszes relev√°ns kulcssz√≥ √∂sszegy≈±jt√©se\n    const searchTerms = new Set();\n    \n    // AI √°ltal tal√°lt kulcsszavak\n    keywords.forEach(kw => {\n      searchTerms.add(kw.toLowerCase());\n      \n      // Szinonim√°k hozz√°ad√°sa\n      Object.entries(furnitureSynonyms).forEach(([key, synonyms]) => {\n        if (kw.toLowerCase().includes(key) || synonyms.some(s => kw.toLowerCase().includes(s))) {\n          synonyms.forEach(s => searchTerms.add(s));\n        }\n      });\n      \n      // St√≠lus kulcsszavak\n      Object.entries(styleKeywords).forEach(([style, words]) => {\n        if (words.some(w => kw.toLowerCase().includes(w))) {\n          words.forEach(w => searchTerms.add(w));\n        }\n      });\n    });\n\n    // B√∫tor sz√∂vegb≈ël is\n    if (furnitureText) {\n      furnitureText.toLowerCase().split(/[,\\s]+/).forEach(term => {\n        if (term.length > 2) searchTerms.add(term);\n      });\n    }\n\n    // Term√©kek pontoz√°sa\n    const scored = products.map(p => {\n      const productText = `${p.name || ''} ${p.category || ''} ${p.description || ''}`.toLowerCase();\n      let score = 0;\n      \n      searchTerms.forEach(term => {\n        if (productText.includes(term)) {\n          // N√©v egyez√©s √©rt√©kesebb\n          if ((p.name || '').toLowerCase().includes(term)) score += 15;\n          // Kateg√≥ria egyez√©s\n          else if ((p.category || '').toLowerCase().includes(term)) score += 10;\n          // Le√≠r√°s egyez√©s\n          else score += 3;\n        }\n      });\n      \n      return { product: p, score };\n    });\n\n    // Top term√©kek, v√°ltozatos kateg√≥ri√°kb√≥l\n    const topScored = scored\n      .filter(s => s.score > 0)\n      .sort((a, b) => b.score - a.score);\n\n    // Kateg√≥ria diverzit√°s biztos√≠t√°sa\n    const selectedProducts = [];\n    const usedCategories = new Set();\n    \n    for (const item of topScored) {\n      const cat = (item.product.category || '').split(' > ')[0];\n      \n      // Els≈ë 4 term√©k b√°rmilyen kateg√≥ri√°b√≥l\n      if (selectedProducts.length < 4) {\n        selectedProducts.push(item.product);\n        usedCategories.add(cat);\n      }\n      // Tov√°bbi term√©kek k√ºl√∂nb√∂z≈ë kateg√≥ri√°kb√≥l\n      else if (selectedProducts.length < 12 && !usedCategories.has(cat)) {\n        selectedProducts.push(item.product);\n        usedCategories.add(cat);\n      }\n      // Ha el√©g kateg√≥ria van, t√∂bbi is j√∂het\n      else if (selectedProducts.length < 12) {\n        selectedProducts.push(item.product);\n      }\n      \n      if (selectedProducts.length >= 12) break;\n    }\n\n    // Ha kev√©s a tal√°lat, t√∂lts√ºk fel random term√©kekkel\n    if (selectedProducts.length < 6) {\n      const additionalProducts = products\n        .filter(p => !selectedProducts.some(sp => sp.id === p.id))\n        .sort(() => Math.random() - 0.5)\n        .slice(0, 6 - selectedProducts.length);\n      \n      selectedProducts.push(...additionalProducts);\n    }\n\n    return selectedProducts;\n  };\n\n  const resetAnalysis = () => {\n    setSelectedImage(null);\n    setImagePreview(null);\n    setAnalysis(null);\n    setAnalysisError(null);\n    setRecommendations([]);\n    setAiKeywords([]);\n  };\n\n  const handleClose = () => {\n    resetAnalysis();\n    if (onClose) onClose();\n  };\n\n  const handleProductClick = (product) => {\n    trackProductView(product);\n    if (onProductRecommendations) {\n      onProductRecommendations([product, ...recommendations.filter(p => p.id !== product.id)]);\n    }\n  };\n\n  const formatPrice = (price) => (price || 0).toLocaleString('hu-HU') + ' Ft';\n\n  return (\n    <div \n      className=\"fixed inset-0 lg:top-[60px] z-[9999] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm\"\n      onClick={handleClose}\n    >\n      <div\n        className=\"w-full max-w-2xl max-h-[90vh] overflow-y-auto bg-white rounded-2xl shadow-2xl\"\n        onClick={(e) => e.stopPropagation()}\n      >\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-5 border-b border-gray-100 bg-gradient-to-r from-secondary-500 to-pink-600\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"p-2.5 bg-white/20 rounded-xl\">\n              <Camera className=\"w-6 h-6 text-white\" />\n            </div>\n            <div>\n              <h2 className=\"text-xl font-bold text-white\">AI Szoba Tervez≈ë</h2>\n              <p className=\"text-sm text-white/80\">\n                {productStats ? `${productStats.total.toLocaleString()} term√©kb≈ël v√°logatunk` : 'T√∂ltsd fel a szob√°d fot√≥j√°t!'}\n              </p>\n            </div>\n          </div>\n          <button\n            onClick={handleClose}\n            className=\"p-2 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors\"\n          >\n            <X className=\"w-6 h-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-5\">\n          {/* Upload Area */}\n          {!imagePreview && (\n            <div\n              onClick={() => fileInputRef.current?.click()}\n              className=\"border-2 border-dashed border-gray-300 rounded-xl p-10 text-center cursor-pointer hover:border-secondary-500 hover:bg-secondary-50/30 transition-all\"\n            >\n              <Upload className=\"w-14 h-14 text-gray-400 mx-auto mb-4\" />\n              <h3 className=\"text-lg font-semibold text-gray-700 mb-2\">\n                Kattints vagy h√∫zd ide a fot√≥t\n              </h3>\n              <p className=\"text-sm text-gray-500\">JPG, PNG vagy WEBP (max 4MB)</p>\n              <p className=\"text-xs text-secondary-700 mt-2\">\n                Az AI elemzi a szob√°t √©s {productStats?.total.toLocaleString() || ''} term√©kb≈ël aj√°nl\n              </p>\n              <input\n                ref={fileInputRef}\n                type=\"file\"\n                accept=\"image/jpeg,image/png,image/webp\"\n                onChange={handleImageSelect}\n                className=\"hidden\"\n              />\n            </div>\n          )}\n\n          {/* Image Preview */}\n          {imagePreview && (\n            <div className=\"space-y-5\">\n              <div className=\"relative rounded-xl overflow-hidden\">\n                <img\n                  src={imagePreview}\n                  alt=\"Szoba el≈ën√©zet\"\n                  className=\"w-full h-56 object-cover\"\n                />\n                <button\n                  onClick={resetAnalysis}\n                  className=\"absolute top-3 right-3 p-2 bg-white/90 rounded-full hover:bg-white transition-colors shadow-lg\"\n                >\n                  <X className=\"w-5 h-5 text-gray-700\" />\n                </button>\n              </div>\n\n              {/* Analyze Button */}\n              {!analysis && !isAnalyzing && !analysisError && (\n                <button\n                  onClick={analyzeRoom}\n                  className=\"w-full py-4 rounded-xl bg-gradient-to-r from-secondary-500 to-pink-600 text-white font-semibold text-lg shadow-lg hover:shadow-xl transition-all hover:scale-[1.02] flex items-center justify-center gap-3\"\n                >\n                  <Sparkles className=\"w-6 h-6\" />\n                  AI Elemz√©s Ind√≠t√°sa\n                </button>\n              )}\n\n              {/* Loading */}\n              {isAnalyzing && (\n                <div className=\"text-center py-8\">\n                  <Loader2 className=\"w-12 h-12 text-secondary-500 animate-spin mx-auto mb-4\" />\n                  <p className=\"text-gray-600 font-medium\">Az AI elemzi a szob√°dat...</p>\n                  <p className=\"text-gray-400 text-sm mt-1\">\n                    {productStats?.total.toLocaleString()} term√©kb≈ël keress√ºk a t√∂k√©leteset\n                  </p>\n                </div>\n              )}\n\n              {/* Error */}\n              {analysisError && (\n                <div className=\"bg-red-50 rounded-xl p-5 text-center\">\n                  <AlertCircle className=\"w-10 h-10 text-red-500 mx-auto mb-3\" />\n                  <p className=\"text-red-700 font-medium mb-4\">{analysisError}</p>\n                  <button\n                    onClick={analyzeRoom}\n                    className=\"px-6 py-2.5 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition-colors inline-flex items-center gap-2\"\n                  >\n                    <RotateCcw className=\"w-4 h-4\" />\n                    √öjrapr√≥b√°l√°s\n                  </button>\n                </div>\n              )}\n\n              {/* Analysis Result */}\n              {analysis && (\n                <div className=\"space-y-5\">\n                  {/* AI Analysis */}\n                  <div className=\"bg-gradient-to-br from-secondary-50 to-pink-50 rounded-xl p-5 border border-secondary-100\">\n                    <div className=\"flex items-center gap-2 mb-3\">\n                      <CheckCircle className=\"w-5 h-5 text-green-500\" />\n                      <h3 className=\"text-lg font-bold text-gray-800\">AI Elemz√©s</h3>\n                    </div>\n                    <div className=\"text-gray-700 whitespace-pre-wrap leading-relaxed text-sm\">\n                      {analysis.split('\\n').map((line, i) => {\n                        if (line.startsWith('üí°')) {\n                          return (\n                            <div key={i} className=\"mt-3 p-3 bg-amber-50 rounded-lg border border-amber-200\">\n                              <div className=\"flex items-start gap-2\">\n                                <Lightbulb className=\"w-5 h-5 text-amber-500 shrink-0\" />\n                                <p className=\"text-amber-800\">{line.replace('üí° ', '')}</p>\n                              </div>\n                            </div>\n                          );\n                        }\n                        return <p key={i}>{line}</p>;\n                      })}\n                    </div>\n                  </div>\n\n                  {/* AI Keywords */}\n                  {aiKeywords.length > 0 && (\n                    <div className=\"flex flex-wrap gap-2\">\n                      {aiKeywords.slice(0, 8).map((kw, i) => (\n                        <span key={i} className=\"px-2.5 py-1 bg-secondary-100 text-secondary-700 text-xs rounded-full\">\n                          {kw}\n                        </span>\n                      ))}\n                    </div>\n                  )}\n\n                  {/* Product Recommendations */}\n                  {recommendations.length > 0 && (\n                    <div>\n                      <h3 className=\"text-lg font-bold text-gray-800 mb-3 flex items-center gap-2\">\n                        <Star className=\"w-5 h-5 text-amber-500\" />\n                        Szem√©lyre szabott aj√°nlatok ({recommendations.length})\n                      </h3>\n                      <div className=\"grid grid-cols-2 sm:grid-cols-3 gap-3\">\n                        {recommendations.slice(0, 6).map((product) => (\n                          <button\n                            key={product.id}\n                            onClick={() => handleProductClick(product)}\n                            className=\"bg-white rounded-lg overflow-hidden border border-gray-200 hover:shadow-md hover:border-secondary-400 transition-all text-left\"\n                          >\n                            <img\n                              src={product.images?.[0] || product.image || product.mainImage}\n                              alt={product.name}\n                              className=\"w-full h-28 object-contain bg-gray-50\"\n                              onError={(e) => { e.target.src = 'data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100\" height=\"100\"><rect fill=\"%23f3f4f6\" width=\"100\" height=\"100\"/></svg>'; }}\n                            />\n                            <div className=\"p-2.5\">\n                              <h4 className=\"font-medium text-sm text-gray-800 line-clamp-1 mb-1\">\n                                {product.name}\n                              </h4>\n                              <p className=\"text-base font-bold text-secondary-700\">\n                                {formatPrice(product.salePrice || product.price)}\n                              </p>\n                            </div>\n                          </button>\n                        ))}\n                      </div>\n                      {recommendations.length > 6 && (\n                        <p className=\"text-center text-sm text-gray-500 mt-3\">\n                          + {recommendations.length - 6} tov√°bbi aj√°nlat\n                        </p>\n                      )}\n                    </div>\n                  )}\n\n                  {/* Show All / New Photo Buttons */}\n                  <div className=\"grid grid-cols-2 gap-3\">\n                    <button\n                      onClick={resetAnalysis}\n                      className=\"py-3 rounded-xl bg-gray-100 text-gray-700 font-semibold hover:bg-gray-200 transition-colors flex items-center justify-center gap-2\"\n                    >\n                      <Upload className=\"w-5 h-5\" />\n                      √öj Fot√≥\n                    </button>\n                    <button\n                      onClick={handleClose}\n                      className=\"py-3 rounded-xl bg-gradient-to-r from-secondary-500 to-pink-600 text-white font-semibold hover:opacity-90 transition-opacity flex items-center justify-center gap-2\"\n                    >\n                      <ShoppingBag className=\"w-5 h-5\" />\n                      Megn√©zem\n                    </button>\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AIRoomDesigner;\n"],"names":["RotateCcw","createLucideIcon","Upload","AIRoomDesigner","products","onProductRecommendations","onClose","selectedImage","setSelectedImage","useState","imagePreview","setImagePreview","isAnalyzing","setIsAnalyzing","analysis","setAnalysis","analysisError","setAnalysisError","recommendations","setRecommendations","aiKeywords","setAiKeywords","fileInputRef","useRef","productStats","useMemo","categories","p","cat","topCategories","a","b","name","handleImageSelect","e","file","_a","reader","analyzeRoom","base64Image","mimeType","result","analyzeImage","responseText","keywords","roomMatch","styleMatch","colorsMatch","furnitureMatch","tippMatch","k","readableAnalysis","matchedProducts","findMatchingProductsAdvanced","error","furnitureText","furnitureSynonyms","styleKeywords","searchTerms","kw","key","synonyms","s","style","words","w","term","topScored","productText","score","selectedProducts","usedCategories","item","additionalProducts","sp","resetAnalysis","handleClose","handleProductClick","product","trackProductView","formatPrice","price","jsx","jsxs","Camera","X","Sparkles","Loader2","AlertCircle","CheckCircle","line","i","Lightbulb","Star","ShoppingBag"],"mappings":"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","x_google_ignoreList":[0,1]}