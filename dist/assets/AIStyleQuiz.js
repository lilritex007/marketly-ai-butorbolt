import{u as Q,j as t,h as Z,n as C}from"./index.js";import{r as x,aT as O,aU as W,aV as X,g as Y,aW as T,j as z,aX as G,aY as _,a3 as J,ai as ee,S as D,ao as F,aZ as te,a_ as se,a$ as R,i as ae,b0 as re,az as ie,R as le,h as oe,w as ne,v as ce,U as de,n as me,X as ge,ap as be,at as he,Y as xe,ag as ye,a6 as fe}from"./icons.js";import{generateText as ue}from"./geminiService.js";import"./vendor.js";const Ne=({products:n,onRecommendations:w,onClose:j})=>{Q(!0);const[u,K]=x.useState(0),[N,I]=x.useState({}),[S,M]=x.useState(!1),[v,P]=x.useState(null),[k,L]=x.useState([]),[ke,pe]=x.useState(""),m=x.useMemo(()=>{if(!n||n.length===0)return null;const e={},s={budget:0,mid:0,premium:0};n.forEach(r=>{const l=(r.category||"Egyéb").split(" > ")[0];e[l]=(e[l]||0)+1;const c=r.salePrice||r.price||0;c<1e5?s.budget++:c<=3e5?s.mid++:s.premium++});const i=Object.entries(e).sort((r,l)=>l[1]-r[1]).slice(0,10).map(([r,l])=>`${r} (${l})`).join(", ");return{total:n.length,topCategories:i,priceRanges:s}},[n]),y=[{id:"space",question:"Milyen a lakásod jelenlegi stílusa?",icon:z,options:[{id:"modern",label:"Modern & Minimalista",icon:O,color:"text-blue-600 bg-blue-50",keywords:["modern","minimalista","letisztult","egyszerű","fehér"]},{id:"scandinavian",label:"Skandináv & Világos",icon:W,color:"text-emerald-600 bg-emerald-50",keywords:["skandináv","natúr","világos","fa","természetes"]},{id:"industrial",label:"Indusztriális & Nyers",icon:X,color:"text-gray-600 bg-gray-100",keywords:["indusztriális","loft","fém","ipari","beton"]},{id:"vintage",label:"Vintage & Retro",icon:Y,color:"text-amber-600 bg-amber-50",keywords:["vintage","retro","antik","klasszikus","régi"]},{id:"bohemian",label:"Bohém & Színes",icon:T,color:"text-pink-600 bg-pink-50",keywords:["bohém","színes","egyedi","mintás","kreatív"]}]},{id:"colors",question:"Milyen színeket preferálsz?",icon:T,options:[{id:"neutral",label:"Semleges (Fehér, Bézs, Szürke)",icon:G,color:"text-gray-500 bg-gray-50",keywords:["fehér","bézs","szürke","krém","natúr"]},{id:"earth",label:"Földszínek (Barna, Zöld)",icon:_,color:"text-amber-700 bg-amber-50",keywords:["barna","zöld","fa","dió","tölgy"]},{id:"bold",label:"Merész (Kék, Piros)",icon:J,color:"text-red-600 bg-red-50",keywords:["kék","piros","sárga","élénk","színes"]},{id:"dark",label:"Sötét (Fekete, Antracit)",icon:ee,color:"text-gray-800 bg-gray-200",keywords:["fekete","antracit","sötét","grafit","éjfekete"]},{id:"pastel",label:"Pasztell (Rózsaszín, Menta)",icon:D,color:"text-secondary-500 bg-secondary-50",keywords:["rózsaszín","menta","pasztell","halvány","lágy"]}]},{id:"budget",question:"Mi a preferált árkategóriád?",icon:F,options:[{id:"budget",label:"Megfizethető (< 100k Ft)",icon:F,color:"text-green-600 bg-green-50"},{id:"mid",label:"Közép (100-300k Ft)",icon:te,color:"text-blue-600 bg-blue-50"},{id:"premium",label:"Prémium (> 300k Ft)",icon:se,color:"text-amber-600 bg-amber-50"},{id:"flexible",label:"Rugalmas",icon:R,color:"text-primary-500 bg-primary-50"}]},{id:"priority",question:"Mi a legfontosabb számodra?",icon:R,options:[{id:"comfort",label:"Kényelem",icon:ae,color:"text-primary-500 bg-primary-50",keywords:["kényelmes","puha","tágas"]},{id:"design",label:"Design",icon:re,color:"text-pink-600 bg-pink-50",keywords:["design","stílusos","elegáns","divatos"]},{id:"durability",label:"Tartósság",icon:ie,color:"text-gray-600 bg-gray-100",keywords:["tartós","strapabíró","erős","masszív"]},{id:"versatility",label:"Sokoldalúság",icon:le,color:"text-blue-600 bg-blue-50",keywords:["praktikus","átalakítható","multifunkciós"]},{id:"eco",label:"Fenntarthatóság",icon:oe,color:"text-green-600 bg-green-50",keywords:["öko","natúr","fenntartható","bio"]}]},{id:"room",question:"Melyik helyiségbe keresel bútort?",icon:z,options:[{id:"living",label:"Nappali",icon:ne,color:"text-primary-500 bg-primary-50",keywords:["kanapé","fotel","dohányzó","tv","nappali","ülőgarnitúra","sarok"]},{id:"bedroom",label:"Hálószoba",icon:ce,color:"text-secondary-700 bg-secondary-50",keywords:["ágy","matrac","éjjeli","hálószoba","gardrób","komód","franciaágy"]},{id:"dining",label:"Étkező",icon:de,color:"text-amber-600 bg-amber-50",keywords:["étkező","asztal","szék","tálaló","étkezőasztal","étkezőszék"]},{id:"office",label:"Dolgozószoba",icon:me,color:"text-gray-600 bg-gray-100",keywords:["íróasztal","iroda","forgószék","polc","könyvespolc"]},{id:"all",label:"Teljes lakás",icon:z,color:"text-emerald-600 bg-emerald-50",keywords:[]}]}],b=y[u],E=(u+1)/y.length*100,B=e=>{const s={...N,[b.id]:e};I(s),u<y.length-1?setTimeout(()=>K(u+1),200):setTimeout(()=>q(s),300)},q=async e=>{M(!0);try{const s=[];y.forEach(o=>{const h=e[o.id],g=o.options.find(A=>A.id===h);g!=null&&g.keywords&&s.push(...g.keywords)});const i=await H(e,s);L(i);const r={modern:"modern, minimalista",scandinavian:"skandináv, világos",industrial:"indusztriális, loft",vintage:"vintage, retro",bohemian:"bohém, színes"},l={neutral:"semleges színeket (fehér, bézs, szürke)",earth:"földszíneket (barna, zöld)",bold:"élénk színeket (kék, piros)",dark:"sötét tónusokat (fekete, antracit)",pastel:"pasztell árnyalatokat"},c={living:"nappaliba",bedroom:"hálószobába",dining:"étkezőbe",office:"dolgozószobába",all:"a teljes lakásba"},p={budget:"100 ezer Ft alatt",mid:"100-300 ezer Ft között",premium:"300 ezer Ft felett",flexible:"rugalmas költségvetéssel"},d=`Te egy profi lakberendező tanácsadó vagy. Készíts személyre szabott profilt és adj konkrét termékajánlásokat!

VÁSÁRLÓ PREFERENCIÁI:
- Stílus: ${r[e.space]||e.space}
- Színek: ${l[e.colors]||e.colors}
- Helyiség: ${c[e.room]||e.room}
- Költségvetés: ${p[e.budget]||e.budget}

ELÉRHETŐ TERMÉKEK (${(m==null?void 0:m.total)||0} db összesen):
${i.slice(0,8).map(o=>`- ${o.name}: ${(o.salePrice||o.price||0).toLocaleString("hu-HU")} Ft`).join(`
`)}

FELADATOD:
1. Írj egy 2-3 mondatos személyre szabott stílusprofilt
2. Magyarázd el, MIÉRT ezeket a termékeket ajánlod (1 mondat)

Legyél barátságos, használj tegezést. Magyarul válaszolj!`,f=await ue(d,{temperature:.8,maxTokens:250});let a;f.success&&f.text?a=f.text:a=$(e),P(a),C(e,a),w&&i.length>0&&w(i)}catch(s){console.error("Quiz hiba:",s);const i=U(e);L(i);const r=$(e);P(r),C(e,r)}finally{M(!1)}},H=async(e,s)=>{var f;if(!n||n.length===0)return[];let i=[...n];e.budget==="budget"?i=i.filter(a=>(a.salePrice||a.price)<1e5):e.budget==="mid"?i=i.filter(a=>{const o=a.salePrice||a.price;return o>=1e5&&o<=3e5}):e.budget==="premium"&&(i=i.filter(a=>(a.salePrice||a.price)>3e5));const r=(f=y.find(a=>a.id==="room"))==null?void 0:f.options.find(a=>a.id===e.room),l=(r==null?void 0:r.keywords)||[],c=[...s,...l],d=i.map(a=>{const o=`${a.name||""} ${a.category||""} ${a.description||""}`.toLowerCase();let h=0;return c.forEach(g=>{o.includes(g.toLowerCase())&&(h+=10)}),l.length>0&&l.forEach(g=>{o.includes(g.toLowerCase())&&(h+=5)}),{product:a,score:h}}).filter(a=>a.score>0).sort((a,o)=>o.score-a.score).slice(0,20).map(a=>a.product);if(d.length>12)return d.sort(()=>Math.random()-.5).slice(0,12);if(d.length<6){const a=i.filter(o=>!d.some(h=>h.id===o.id)).sort(()=>Math.random()-.5).slice(0,12-d.length);return[...d,...a]}return d},U=e=>{if(!n||n.length===0)return[];let s=[...n];e.budget==="budget"?s=s.filter(r=>(r.salePrice||r.price)<1e5):e.budget==="mid"?s=s.filter(r=>{const l=r.salePrice||r.price;return l>=1e5&&l<=3e5}):e.budget==="premium"&&(s=s.filter(r=>(r.salePrice||r.price)>3e5));const i={living:["kanapé","fotel","dohányzó","tv","nappali","ülőgarnitúra"],bedroom:["ágy","matrac","éjjeli","hálószoba","gardrób","komód"],dining:["étkező","asztal","szék","tálaló"],office:["íróasztal","iroda","forgószék","polc"]};if(e.room&&e.room!=="all"){const r=i[e.room]||[];if(r.length>0){const l=s.filter(c=>r.some(p=>(c.name||"").toLowerCase().includes(p)||(c.category||"").toLowerCase().includes(p)));l.length>0&&(s=l)}}return s.sort(()=>Math.random()-.5).slice(0,12)},$=e=>{const s={modern:"Modern, letisztult ízlésed van",scandinavian:"A skandináv egyszerűséget kedveled",industrial:"Az ipari, loft stílus híve vagy",vintage:"A vintage báj rajongója vagy",bohemian:"Egyedi, bohém stílusod van"},i={comfort:"a kényelmet",design:"az esztétikát",durability:"a minőséget",versatility:"a praktikumot",eco:"a környezettudatosságot"};return`${s[e.space]||"Egyedi ízlésed van"}, és ${i[e.priority]||"a minőséget"} helyezed előtérbe. Az ajánlott termékek tökéletesen illenek a stílusodhoz!`},V=(b==null?void 0:b.icon)||z;return t.jsx("div",{className:"fixed inset-0 lg:top-[60px] z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",onClick:j,children:t.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto shadow-2xl",onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"bg-gradient-to-r from-primary-500 to-secondary-700 p-5 relative",children:[t.jsx("button",{onClick:j,className:"absolute top-3 right-3 w-8 h-8 flex items-center justify-center text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors",children:t.jsx(ge,{className:"w-5 h-5"})}),t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:t.jsx(D,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-white",children:"Style DNA Quiz"}),t.jsx("p",{className:"text-white/80 text-sm",children:m?`${m.total.toLocaleString()} termékből válogatunk`:"Fedezd fel a stílusodat!"})]})]}),!v&&!S&&t.jsxs("div",{className:"mt-4",children:[t.jsxs("div",{className:"flex justify-between text-xs text-white/80 mb-1.5",children:[t.jsxs("span",{children:["Kérdés ",u+1,"/",y.length]}),t.jsxs("span",{children:[Math.round(E),"%"]})]}),t.jsx("div",{className:"h-2 bg-white/20 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-white rounded-full transition-all duration-300",style:{width:`${E}%`}})})]})]}),t.jsx("div",{className:"p-5",children:S?t.jsxs("div",{className:"py-12 text-center",children:[t.jsx(be,{className:"w-12 h-12 text-primary-500 animate-spin mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"AI elemzés folyamatban..."}),t.jsxs("p",{className:"text-gray-500 text-sm",children:[m==null?void 0:m.total.toLocaleString()," termékből keressük a neked valókat"]})]}):v?t.jsxs("div",{className:"space-y-5",children:[t.jsxs("div",{className:"bg-gradient-to-br from-primary-50 to-secondary-50 rounded-xl p-5 border border-primary-100",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(he,{className:"w-5 h-5 text-green-500"}),t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"A Te Style DNA-d"})]}),t.jsx("p",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap",children:v})]}),k.length>0&&t.jsxs("div",{children:[t.jsxs("h4",{className:"text-sm font-bold text-gray-700 mb-3 flex items-center gap-2",children:[t.jsx(xe,{className:"w-4 h-4 text-amber-500"}),"Személyre szabott ajánlatok (",k.length,")"]}),t.jsx("div",{className:"grid grid-cols-3 gap-2",children:k.slice(0,6).map(e=>{var s;return t.jsxs("div",{className:"bg-gray-50 rounded-lg p-2 text-center hover:bg-primary-50 transition-colors cursor-pointer",children:[t.jsx("img",{src:((s=e.images)==null?void 0:s[0])||e.image||"/placeholder.png",alt:e.name,className:"w-full aspect-square object-contain rounded bg-white mb-1",onError:i=>{i.target.src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100"><rect fill="%23f3f4f6" width="100" height="100"/><text x="50%" y="50%" text-anchor="middle" dy=".3em" fill="%239ca3af" font-size="12">Kép</text></svg>'}}),t.jsx("p",{className:"text-[10px] text-gray-600 truncate",children:e.name}),t.jsx("p",{className:"text-xs font-bold text-primary-500",children:Z(e.salePrice||e.price)})]},e.id)})}),k.length>6&&t.jsxs("p",{className:"text-center text-xs text-gray-500 mt-2",children:["+ ",k.length-6," további ajánlat"]})]}),t.jsxs("button",{onClick:j,className:"w-full bg-gradient-to-r from-primary-500 to-secondary-700 text-white py-3.5 rounded-xl font-bold hover:opacity-90 transition-opacity flex items-center justify-center gap-2",children:[t.jsx(ye,{className:"w-5 h-5"}),"Termékek megtekintése"]})]}):t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[t.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-xl flex items-center justify-center shrink-0",children:t.jsx(V,{className:"w-5 h-5 text-primary-500"})}),t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:b.question})]}),t.jsx("div",{className:"space-y-2",children:b.options.map(e=>{const s=e.icon,i=N[b.id]===e.id;return t.jsxs("button",{onClick:()=>B(e.id),className:`
                        w-full p-3.5 rounded-xl border-2 text-left transition-all
                        flex items-center gap-3
                        ${i?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-primary-300 hover:bg-gray-50"}
                      `,children:[t.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center shrink-0 ${e.color}`,children:t.jsx(s,{className:"w-5 h-5"})}),t.jsx("span",{className:"text-sm font-medium text-gray-800 flex-1",children:e.label}),i&&t.jsx(fe,{className:"w-5 h-5 text-primary-500"})]},e.id)})})]})})]})})};export{Ne as default};
//# sourceMappingURL=AIStyleQuiz.js.map
