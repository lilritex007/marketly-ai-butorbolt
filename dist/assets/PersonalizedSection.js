import{j as s,A as ne,B as le,b as de,d as ce,c as me,e as xe,w as ge,r as he,x as be,y as ye,D as J,F as X,G as ue,u as pe,E as fe}from"./index.js";import{r as n,S as Z,g as ee,a4 as we,a as ke,R as ve,a0 as je,I as Ne}from"./icons.js";import{P as ze}from"./ProductCarousel.js";import"./vendor.js";const Ce=({title:d,id:T,subtitle:z,Icon:C,accentClass:K="from-primary-500 to-secondary-700",badge:S,eyebrow:x,helpText:h,meta:$,contextLabel:b="",actions:p=null,prominent:u=!1,className:B=""})=>s.jsxs("div",{className:`relative flex flex-col gap-4 mb-6 lg:mb-8 ${u?"p-4 sm:p-5 rounded-3xl bg-white/70 border border-gray-100 shadow-sm backdrop-blur-sm section-header-hero":""} ${B}`,children:[u&&s.jsx("div",{className:"absolute inset-0 rounded-3xl bg-gradient-to-r from-white/90 via-white/70 to-transparent pointer-events-none"}),s.jsxs("div",{className:u?"relative z-10":"",children:[x&&s.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/90 border border-gray-100 text-gray-700 text-xs font-semibold shadow-sm w-fit",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-primary-500"}),x]}),s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-12 h-12 sm:w-14 sm:h-14 rounded-2xl bg-gradient-to-br ${K} flex items-center justify-center shadow-sm`,children:C&&s.jsx(C,{className:"w-6 h-6 sm:w-7 sm:h-7 text-white","aria-hidden":!0})}),s.jsxs("div",{children:[s.jsx("h2",{id:T,className:`section-title ${u?"text-2xl sm:text-3xl lg:text-4xl":"text-xl sm:text-2xl lg:text-3xl"} font-extrabold lux-title`,children:d}),z&&s.jsx("p",{className:`section-subtitle ${u?"text-base sm:text-lg":"text-sm"} lux-subtitle`,children:z})]})]}),p&&s.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:p})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[S&&s.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/90 border border-gray-100 text-gray-700 text-xs font-semibold shadow-sm",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-primary-500"}),S]}),b&&s.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/90 border border-gray-100 text-gray-700 text-xs font-semibold shadow-sm",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-primary-500"}),b]}),$&&s.jsx("span",{className:"text-xs text-gray-500",children:$}),h&&s.jsx("span",{className:"text-xs text-gray-400",children:h})]})]})]}),Re=({products:d,onProductClick:T,onToggleWishlist:z,wishlist:C=[],onAddToCart:K,contextLabel:S="",cartItems:x=[]})=>{var Q;const[h,$]=n.useState("foryou"),[b,p]=n.useState(0),[u,B]=n.useState(36),[M,I]=n.useState("match"),[y,P]=n.useState([]),[se,te]=n.useState(!1),[g,H]=n.useState(ne()),re=n.useMemo(()=>le("similar-cta"),[]),j=n.useMemo(()=>de(50).filter(e=>e.inStock??e.in_stock??!0),[]),m=n.useMemo(()=>ce(),[]),R=n.useMemo(()=>me(6),[]),V=n.useMemo(()=>xe(6),[]),O=n.useMemo(()=>ge(),[]);n.useEffect(()=>{he(`personalized-${h}`,"section_impression")},[h]);const U=n.useMemo(()=>d!=null&&d.length?[...be(d,120).filter(t=>t.inStock??t.in_stock??!0)].sort(()=>(b%2===0?1:-1)*(Math.random()-.5)):[],[d,b]),ae=n.useMemo(()=>d!=null&&d.length?d.filter(e=>e.inStock??e.in_stock??!0).filter(e=>(e.salePrice||e.price)>5e4).sort(()=>Math.random()-.5).slice(0,120):[],[d,b]),oe=n.useMemo(()=>{if(!(d!=null&&d.length))return[];const e=Array.isArray(x)&&x.length>0?x:j;if(!e||e.length===0)return[];const t=new Map;return e.forEach(a=>{ye(a,d,8).forEach(o=>{o&&o.id&&(o.inStock??o.in_stock??!0)&&t.set(o.id,o)})}),Array.from(t.values()).slice(0,120)},[d,x,j]),D=[{id:"foryou",label:"Neked ajánljuk",icon:Z,products:U},{id:"recent",label:"Nemrég nézted",icon:ee,products:j},{id:"trending",label:"Trendi most",icon:we,products:ae},{id:"cart",label:"Hasonló a kosaradhoz",icon:ke,products:oe}],w=((Q=D.find(e=>e.id===h))==null?void 0:Q.products)||[],L=n.useCallback(e=>{if(!e)return 0;const t=`${e.name||""} ${e.category||""} ${e.description||""}`.toLowerCase();return y.reduce((a,r)=>{var o,c;return r.type==="category"?a+((e.category||"").toLowerCase().includes(r.value.toLowerCase())?2:0):r.type==="style"?a+((o=r.keywords)!=null&&o.some(v=>t.includes(v))?2:0):r.type==="room"?a+((c=r.keywords)!=null&&c.some(v=>t.includes(v))?2:0):a},0)},[y]),k=n.useMemo(()=>{if(!y.length)return w;const e=w.filter(t=>L(t)>0);return M==="match"?[...e].sort((t,a)=>L(a)-L(t)):[...e].sort(()=>(b%2===0?1:-1)*(Math.random()-.5))},[w,y,M,L,b]),G=k.slice(0,Math.max(24,u)),f=n.useMemo(()=>{if(R.length>0)return R;const e=new Map;return d.forEach(t=>{t!=null&&t.category&&e.set(t.category,(e.get(t.category)||0)+1)}),Array.from(e.entries()).sort((t,a)=>a[1]-t[1]).slice(0,6).map(([t])=>t)},[R,d]),ie=e=>{var c,v;if(!e)return[];const t=[],a=e.category||"";if(Array.isArray(x)&&x.length>0?x.map(l=>l.category||"").filter(Boolean).some(l=>a.toLowerCase().includes(l.toLowerCase()))&&t.push("Hasonló a kosaradhoz"):j.length>0&&j.map(l=>l.category||"").filter(Boolean).some(l=>a.toLowerCase().includes(l.toLowerCase()))&&t.push("Hasonló a korábban nézett termékeidhez"),R.some(i=>a.toLowerCase().includes(i.toLowerCase()))&&t.push(`Kedvelt kategória: ${a}`),a.split(">").map(i=>i.trim().toLowerCase()).filter(Boolean).some(i=>{var l;return(((l=O.categories)==null?void 0:l[i])||0)>0})&&t.push("Tetszéseid alapján"),`${e.name||""} ${e.category||""}`.toLowerCase().split(/[\s,\-\/]+/).map(i=>i.trim()).filter(i=>i.length>3).some(i=>{var l;return(((l=O.keywords)==null?void 0:l[i])||0)>0})&&t.push("Kulcsszavas egyezés a kedveléseidből"),V.length>0){const i=V.find(l=>{const N=(l.query||"").toLowerCase(),F=`${e.name||""} ${e.category||""} ${e.description||""}`.toLowerCase();return N&&F.includes(N)});i!=null&&i.query&&t.push(`Korábbi keresés: “${i.query}”`)}if(m!=null&&m.answers){const{space:i,room:l}=m.answers,N=`${e.name||""} ${e.category||""} ${e.description||""}`.toLowerCase(),F={modern:["modern","minimalista","letisztult"],scandinavian:["skandináv","natúr","világos","fehér"],industrial:["indusztriális","loft","fém","ipari"],vintage:["vintage","retro","antik"],bohemian:["bohém","színes","mintás"]};i&&F[i]&&F[i].some(W=>N.includes(W))&&((c=g.avoidStyles)!=null&&c.includes(i)||t.push(`Stílus illeszkedés: ${i}`));const Y={living:["kanapé","fotel","dohányzó","tv","nappali"],bedroom:["ágy","matrac","éjjeli","hálószoba"],dining:["étkező","asztal","szék"],office:["íróasztal","iroda","forgószék"]};l&&Y[l]&&Y[l].some(W=>N.includes(W))&&((v=g.avoidRooms)!=null&&v.includes(l)||t.push(`Szoba típusa: ${l}`))}return t.slice(0,2)};n.useEffect(()=>{J("similar-cta","impression")},[]);const E=[{id:"modern",label:"Modern",keywords:["modern","minimalista","letisztult"]},{id:"scandinavian",label:"Skandináv",keywords:["skandináv","natúr","világos","fehér"]},{id:"industrial",label:"Indusztriális",keywords:["indusztriális","loft","fém","ipari"]},{id:"vintage",label:"Vintage",keywords:["vintage","retro","antik"]},{id:"bohemian",label:"Bohém",keywords:["bohém","színes","mintás"]}],A=[{id:"living",label:"Nappali",keywords:["kanapé","fotel","dohányzó","tv","nappali"]},{id:"bedroom",label:"Hálószoba",keywords:["ágy","matrac","éjjeli","hálószoba"]},{id:"dining",label:"Étkező",keywords:["étkező","asztal","szék"]},{id:"office",label:"Iroda",keywords:["íróasztal","iroda","forgószék"]}],q=n.useMemo(()=>{const e={categories:new Map,styles:new Map,rooms:new Map};return w.forEach(t=>{const a=`${t.name||""} ${t.category||""} ${t.description||""}`.toLowerCase();f.forEach(r=>{(t.category||"").toLowerCase().includes(r.toLowerCase())&&e.categories.set(r,(e.categories.get(r)||0)+1)}),E.forEach(r=>{var o;(o=r.keywords)!=null&&o.some(c=>a.includes(c))&&e.styles.set(r.id,(e.styles.get(r.id)||0)+1)}),A.forEach(r=>{var o;(o=r.keywords)!=null&&o.some(c=>a.includes(c))&&e.rooms.set(r.id,(e.rooms.get(r.id)||0)+1)})}),e},[w,f,E,A]),_=e=>{P(t=>{if(t.find(o=>o.type===e.type&&o.id===e.id))return t.filter(o=>!(o.type===e.type&&o.id===e.id));const r=[...t,e];return r.length>3?r.slice(r.length-3):r})};return k.length<2&&U.length<2?null:s.jsxs("section",{className:"section-shell section-world section-world--personal relative py-10 sm:py-14 lg:py-20 overflow-hidden","aria-label":"Személyre szabott ajánlások",role:"region","data-section":"personalized",children:[s.jsx("div",{className:"absolute -top-20 -right-16 w-72 h-72 bg-primary-200/30 blur-3xl rounded-full","aria-hidden":!0}),s.jsx("div",{className:"absolute -bottom-24 -left-16 w-80 h-80 bg-secondary-200/30 blur-3xl rounded-full","aria-hidden":!0}),s.jsx("div",{className:"w-full max-w-[2000px] mx-auto px-0 lg:px-10 xl:px-16",children:s.jsxs("div",{className:"section-frame",children:[s.jsx(Ce,{id:"personalized-heading",title:"Személyre szabva neked",subtitle:m!=null&&m.styleDNA?m.styleDNA.split(".")[0]:"AI ajánlások a böngészésed alapján",Icon:Z,accentClass:"from-primary-500 to-secondary-700",eyebrow:"Neked szól",badge:m!=null&&m.styleDNA?"Style DNA aktív":"AI ajánlás",contextLabel:S,prominent:!0,className:"border border-primary-100 shadow-sm section-header-hero section-header-hero--personal",meta:`Megjelenítve: ${Math.min(G.length,k.length)} / ${k.length} termék`,helpText:"Csak készleten lévő termékek",actions:s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsx("div",{className:"inline-flex items-center rounded-full bg-white border border-gray-100 shadow-sm p-1",children:[24,36,48].map(e=>s.jsxs("button",{onClick:()=>B(e),className:`px-3 py-1.5 rounded-full text-xs font-semibold transition-colors min-h-[36px] ${u===e?"bg-primary-500 text-white":"text-gray-600 hover:bg-gray-100"}`,children:[e," db"]},e))}),s.jsxs("button",{onClick:()=>{J("similar-cta","click"),re==="A"&&f.length>0&&P(f.slice(0,2).map(e=>({id:e,type:"category",value:e}))),p(e=>e+1)},className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg text-primary-700 bg-primary-50 border border-primary-100 hover:bg-primary-100 transition-colors text-sm font-semibold min-h-[44px]",children:[s.jsx(ve,{className:"w-4 h-4"}),b%2===0?"Hasonlókat kérek":"Frissítem"]}),s.jsxs("button",{type:"button",onClick:()=>te(e=>!e),className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg text-gray-600 bg-white border border-gray-200 hover:bg-gray-50 transition-colors text-sm font-semibold min-h-[44px]",children:[s.jsx(je,{className:"w-4 h-4"}),"Miért ezt?"]})]})}),(m==null?void 0:m.styleDNA)&&s.jsxs("div",{className:"mb-4 inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-white border border-primary-100 text-primary-700 text-xs font-semibold shadow-sm",children:[s.jsx(Ne,{className:"w-3.5 h-3.5"}),"Style DNA aktív – személyre szabott ajánlások"]}),se&&s.jsxs("div",{className:"mb-6 rounded-2xl border border-gray-200 bg-white p-4 sm:p-5 shadow-sm",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-3",children:[s.jsx("span",{className:"text-sm font-bold text-gray-900",children:"Miért ezeket látod?"}),s.jsx("span",{className:"text-xs text-gray-500",children:"Kattints a finomhangoláshoz"})]}),s.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[V.slice(0,4).map(e=>s.jsxs("span",{className:"px-2.5 py-1 rounded-full bg-gray-100 text-xs text-gray-600",children:["Keresés: “",e.query,"”"]},e.query)),f.slice(0,4).map(e=>s.jsxs("span",{className:"px-2.5 py-1 rounded-full bg-gray-100 text-xs text-gray-600",children:["Kedvelt: ",e]},e))]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[s.jsx("span",{className:"text-xs text-gray-500 mr-1",children:"Kevesebb stílus:"}),E.map(e=>{var t;return s.jsx("button",{type:"button",onClick:()=>{var o;const a=(o=g.avoidStyles)!=null&&o.includes(e.id)?g.avoidStyles.filter(c=>c!==e.id):[...g.avoidStyles||[],e.id],r=X({avoidStyles:a});H(r),p(c=>c+1)},className:`px-3 py-1.5 rounded-full text-xs font-semibold border transition-colors ${(t=g.avoidStyles)!=null&&t.includes(e.id)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-600 border-gray-200 hover:bg-gray-50"}`,children:e.label},e.id)})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("span",{className:"text-xs text-gray-500 mr-1",children:"Kevesebb szoba:"}),A.map(e=>{var t;return s.jsx("button",{type:"button",onClick:()=>{var o;const a=(o=g.avoidRooms)!=null&&o.includes(e.id)?g.avoidRooms.filter(c=>c!==e.id):[...g.avoidRooms||[],e.id],r=X({avoidRooms:a});H(r),p(c=>c+1)},className:`px-3 py-1.5 rounded-full text-xs font-semibold border transition-colors ${(t=g.avoidRooms)!=null&&t.includes(e.id)?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-600 border-gray-200 hover:bg-gray-50"}`,children:e.label},e.id)}),s.jsx("button",{type:"button",onClick:()=>{const e=ue();H(e),p(t=>t+1)},className:"px-3 py-1.5 rounded-full text-xs font-semibold border border-gray-200 text-gray-600 hover:bg-gray-50",children:"Reset"})]})]}),s.jsx("div",{className:"flex gap-2 mb-6 overflow-x-auto pb-2 scrollbar-hide",children:D.map(e=>{var o;const t=e.icon,a=h===e.id,r=((o=e.products)==null?void 0:o.length)||0;return r===0&&e.id!=="foryou"?null:s.jsxs("button",{onClick:()=>$(e.id),className:`
                  flex items-center gap-2 px-4 py-2.5 rounded-full whitespace-nowrap transition-all border
                  ${a?"bg-primary-500 text-white shadow-lg border-primary-500":"bg-white text-gray-700 hover:bg-gray-100 shadow border-gray-100"}
                `,children:[s.jsx(t,{className:`w-4 h-4 ${a?"text-white":"text-primary-500"}`}),s.jsx("span",{className:"font-medium text-sm",children:e.label}),r>0&&s.jsx("span",{className:`
                    text-xs px-1.5 py-0.5 rounded-full
                    ${a?"bg-white/20 text-white":"bg-primary-100 text-primary-600"}
                  `,children:r})]},e.id)})}),f.length>0&&s.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-6",children:[s.jsx("span",{className:"text-xs text-gray-500 mr-1",children:"Fókusz:"}),s.jsxs("button",{type:"button",onClick:()=>P([]),className:`px-3 py-1.5 rounded-full text-xs font-semibold border transition-colors ${y.length===0?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-600 border-gray-100 hover:bg-gray-50"}`,children:["Összes (",w.length,")"]}),f.map(e=>s.jsxs("button",{type:"button",onClick:()=>_({id:e,type:"category",value:e}),className:`px-3 py-1.5 rounded-full text-xs font-semibold border transition-colors ${y.some(t=>t.type==="category"&&t.id===e)?"bg-primary-500 text-white border-primary-500":"bg-white text-gray-600 border-gray-100 hover:bg-gray-50"}`,children:[e," (",q.categories.get(e)||0,")"]},e)),E.map(e=>s.jsxs("button",{type:"button",onClick:()=>_({id:e.id,type:"style",keywords:e.keywords}),className:`px-3 py-1.5 rounded-full text-xs font-semibold border transition-colors ${y.some(t=>t.type==="style"&&t.id===e.id)?"bg-secondary-600 text-white border-secondary-600":"bg-white text-gray-600 border-gray-100 hover:bg-gray-50"}`,children:[e.label," (",q.styles.get(e.id)||0,")"]},e.id)),A.map(e=>s.jsxs("button",{type:"button",onClick:()=>_({id:e.id,type:"room",keywords:e.keywords}),className:`px-3 py-1.5 rounded-full text-xs font-semibold border transition-colors ${y.some(t=>t.type==="room"&&t.id===e.id)?"bg-emerald-600 text-white border-emerald-600":"bg-white text-gray-600 border-gray-100 hover:bg-gray-50"}`,children:[e.label," (",q.rooms.get(e.id)||0,")"]},e.id)),y.length>0&&s.jsxs("div",{className:"ml-auto flex flex-wrap items-center gap-2",children:[s.jsx("button",{type:"button",onClick:()=>I("match"),className:`px-3 py-1.5 rounded-full text-xs font-semibold border transition-colors ${M==="match"?"bg-primary-600 text-white border-primary-600":"bg-white text-gray-600 border-gray-200 hover:bg-gray-50"}`,children:"Legjobb illeszkedés"}),s.jsx("button",{type:"button",onClick:()=>I("mix"),className:`px-3 py-1.5 rounded-full text-xs font-semibold border transition-colors ${M==="mix"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-600 border-gray-200 hover:bg-gray-50"}`,children:"Változatos"})]})]}),k.length===0?s.jsxs("div",{className:"mt-6 rounded-2xl border border-gray-200 bg-white p-6 text-center",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"Nincs találat a fókusz alapján"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Próbálj más fókuszt, vagy állítsd vissza az összesre."}),s.jsx("button",{type:"button",onClick:()=>P([]),className:"mt-3 inline-flex items-center justify-center px-4 py-2 rounded-full bg-gray-900 text-white text-xs font-semibold",children:"Fókusz törlése"})]}):s.jsx(ze,{className:"mt-2",children:G.map((e,t)=>{const a=pe(e),r=a!==null&&a<=3?`Utolsó ${a} db`:"";return s.jsx(fe,{product:e,onToggleWishlist:z,isWishlisted:C.includes(e.id),onQuickView:T,onAddToCart:K,index:t,highlightBadge:r,recommendationReasons:ie(e),sectionId:`personalized-${h}`,showFeedback:!0,size:"compact",tone:"personal"},e.id)})}),h==="recent"&&k.length===0&&s.jsxs("div",{className:"text-center py-12 bg-white rounded-2xl shadow-inner",children:[s.jsx(ee,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Még nem néztél meg termékeket"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Böngéssz a kínálatban!"})]})]})})]})};export{Re as default};
//# sourceMappingURL=PersonalizedSection.js.map
