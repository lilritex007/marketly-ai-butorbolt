{"version":3,"file":"PersonalizedSection.js","sources":["../../src/components/landing/SectionHeader.jsx","../../src/components/home/PersonalizedSection.jsx"],"sourcesContent":["import React from 'react';\n\nconst SectionHeader = ({\n  title,\n  id,\n  subtitle,\n  Icon,\n  accentClass = 'from-primary-500 to-secondary-700',\n  badge,\n  eyebrow,\n  helpText,\n  meta,\n  contextLabel = '',\n  actions = null,\n  prominent = false,\n  className = ''\n}) => {\n  return (\n    <div className={`relative flex flex-col gap-4 mb-6 lg:mb-8 ${prominent ? 'p-4 sm:p-5 rounded-3xl bg-white/70 border border-gray-100 shadow-sm backdrop-blur-sm section-header-hero' : ''} ${className}`}>\n      {prominent && (\n        <div className=\"absolute inset-0 rounded-3xl bg-gradient-to-r from-white/90 via-white/70 to-transparent pointer-events-none\" />\n      )}\n      <div className={prominent ? 'relative z-10' : ''}>\n      {eyebrow && (\n        <div className=\"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/90 border border-gray-100 text-gray-700 text-xs font-semibold shadow-sm w-fit\">\n          <span className=\"w-1.5 h-1.5 rounded-full bg-primary-500\" />\n          {eyebrow}\n        </div>\n      )}\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\n        <div className=\"flex items-center gap-3\">\n          <div className={`w-12 h-12 sm:w-14 sm:h-14 rounded-2xl bg-gradient-to-br ${accentClass} flex items-center justify-center shadow-sm`}>\n            {Icon && <Icon className=\"w-6 h-6 sm:w-7 sm:h-7 text-white\" aria-hidden />}\n          </div>\n          <div>\n            <h2 id={id} className={`section-title ${prominent ? 'text-2xl sm:text-3xl lg:text-4xl' : 'text-xl sm:text-2xl lg:text-3xl'} font-extrabold lux-title`}>\n              {title}\n            </h2>\n            {subtitle && <p className={`section-subtitle ${prominent ? 'text-base sm:text-lg' : 'text-sm'} lux-subtitle`}>{subtitle}</p>}\n          </div>\n        </div>\n        {actions && (\n          <div className=\"flex items-center gap-2 flex-wrap\">{actions}</div>\n        )}\n      </div>\n      <div className=\"flex flex-wrap items-center gap-2\">\n        {badge && (\n          <span className=\"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/90 border border-gray-100 text-gray-700 text-xs font-semibold shadow-sm\">\n            <span className=\"w-1.5 h-1.5 rounded-full bg-primary-500\" />\n            {badge}\n          </span>\n        )}\n        {contextLabel && (\n          <span className=\"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/90 border border-gray-100 text-gray-700 text-xs font-semibold shadow-sm\">\n            <span className=\"w-1.5 h-1.5 rounded-full bg-primary-500\" />\n            {contextLabel}\n          </span>\n        )}\n        {meta && <span className=\"text-xs text-gray-500\">{meta}</span>}\n        {helpText && <span className=\"text-xs text-gray-400\">{helpText}</span>}\n      </div>\n      </div>\n    </div>\n  );\n};\n\nexport default SectionHeader;\n","import React, { useState, useEffect, useMemo, useCallback } from 'react';\nimport { Sparkles, Clock, TrendingUp, RefreshCw, ShoppingCart, Info, SlidersHorizontal } from 'lucide-react';\nimport {\n  getViewedProducts,\n  getPersonalizedRecommendations,\n  getStyleDNA,\n  getTopCategories,\n  getSearchHistory,\n  getSimilarProducts,\n  getRecommendationTweaks,\n  setRecommendationTweaks,\n  resetRecommendationTweaks,\n  getABVariant,\n  trackABEvent,\n  trackSectionEvent,\n  getPreferenceSignals\n} from '../../services/userPreferencesService';\nimport SectionHeader from '../landing/SectionHeader';\nimport { EnhancedProductCard } from '../product/EnhancedProductCard';\nimport ProductCarousel from '../ui/ProductCarousel';\nimport { getStockLevel } from '../../utils/helpers';\n\n/**\n * PersonalizedSection - Személyre szabott főoldal szekciók\n * Recently Viewed + For You + Trending\n */\nconst PersonalizedSection = ({ \n  products, \n  onProductClick, \n  onToggleWishlist, \n  wishlist = [],\n  onAddToCart,\n  contextLabel = '',\n  cartItems = []\n}) => {\n  const [activeTab, setActiveTab] = useState('foryou');\n  const [refreshKey, setRefreshKey] = useState(0);\n  const [viewSize, setViewSize] = useState(36);\n  const [focusOrder, setFocusOrder] = useState('match');\n  const [focusFilters, setFocusFilters] = useState([]);\n  const [showWhyPanel, setShowWhyPanel] = useState(false);\n  const [recoTweaks, setRecoTweaks] = useState(getRecommendationTweaks());\n  const abVariant = useMemo(() => getABVariant('similar-cta'), []);\n  // User adatok\n  const recentlyViewed = useMemo(() => getViewedProducts(50).filter((p) => (p.inStock ?? p.in_stock ?? true)), []);\n  const styleDNA = useMemo(() => getStyleDNA(), []);\n  const topCategories = useMemo(() => getTopCategories(6), []);\n  const searchHistory = useMemo(() => getSearchHistory(6), []);\n  const preferenceSignals = useMemo(() => getPreferenceSignals(), []);\n\n  useEffect(() => {\n    trackSectionEvent(`personalized-${activeTab}`, 'section_impression');\n  }, [activeTab]);\n  \n  // Személyre szabott ajánlások\n  const forYouProducts = useMemo(() => {\n    if (!products?.length) return [];\n    const base = getPersonalizedRecommendations(products, 120).filter((p) => (p.inStock ?? p.in_stock ?? true));\n    return [...base].sort(() => (refreshKey % 2 === 0 ? 1 : -1) * (Math.random() - 0.5));\n  }, [products, refreshKey]);\n  \n  // Trending - top árkategória, random mix\n  const trendingProducts = useMemo(() => {\n    if (!products?.length) return [];\n    return products\n      .filter(p => (p.inStock ?? p.in_stock ?? true))\n      .filter(p => (p.salePrice || p.price) > 50000)\n      .sort(() => Math.random() - 0.5)\n      .slice(0, 120);\n  }, [products, refreshKey]);\n\n  const cartBasedProducts = useMemo(() => {\n    if (!products?.length) return [];\n    const base = Array.isArray(cartItems) && cartItems.length > 0 ? cartItems : recentlyViewed;\n    if (!base || base.length === 0) return [];\n    const merged = new Map();\n    base.forEach((p) => {\n      const similar = getSimilarProducts(p, products, 8);\n      similar.forEach((item) => {\n        if (item && item.id && (item.inStock ?? item.in_stock ?? true)) merged.set(item.id, item);\n      });\n    });\n    return Array.from(merged.values()).slice(0, 120);\n  }, [products, cartItems, recentlyViewed]);\n\n  const tabs = [\n    { id: 'foryou', label: 'Neked ajánljuk', icon: Sparkles, products: forYouProducts },\n    { id: 'recent', label: 'Nemrég nézted', icon: Clock, products: recentlyViewed },\n    { id: 'trending', label: 'Trendi most', icon: TrendingUp, products: trendingProducts },\n    { id: 'cart', label: 'Hasonló a kosaradhoz', icon: ShoppingCart, products: cartBasedProducts },\n  ];\n\n  const currentProductsRaw = tabs.find(t => t.id === activeTab)?.products || [];\n  const getFocusScore = useCallback((product) => {\n    if (!product) return 0;\n    const text = `${product.name || ''} ${product.category || ''} ${product.description || ''}`.toLowerCase();\n    return focusFilters.reduce((score, f) => {\n      if (f.type === 'category') return score + ((product.category || '').toLowerCase().includes(f.value.toLowerCase()) ? 2 : 0);\n      if (f.type === 'style') return score + (f.keywords?.some((kw) => text.includes(kw)) ? 2 : 0);\n      if (f.type === 'room') return score + (f.keywords?.some((kw) => text.includes(kw)) ? 2 : 0);\n      return score;\n    }, 0);\n  }, [focusFilters]);\n\n  const currentProducts = useMemo(() => {\n    if (!focusFilters.length) return currentProductsRaw;\n    const filtered = currentProductsRaw.filter((p) => getFocusScore(p) > 0);\n    if (focusOrder === 'match') {\n      return [...filtered].sort((a, b) => getFocusScore(b) - getFocusScore(a));\n    }\n    return [...filtered].sort(() => (refreshKey % 2 === 0 ? 1 : -1) * (Math.random() - 0.5));\n  }, [currentProductsRaw, focusFilters, focusOrder, getFocusScore, refreshKey]);\n\n  const visibleProducts = currentProducts.slice(0, Math.max(24, viewSize));\n\n  const fallbackCategories = useMemo(() => {\n    if (topCategories.length > 0) return topCategories;\n    const counts = new Map();\n    products.forEach((p) => {\n      if (p?.category) counts.set(p.category, (counts.get(p.category) || 0) + 1);\n    });\n    return Array.from(counts.entries())\n      .sort((a, b) => b[1] - a[1])\n      .slice(0, 6)\n      .map(([name]) => name);\n  }, [topCategories, products]);\n\n  const buildRecommendationReasons = (product) => {\n    if (!product) return [];\n    const reasons = [];\n    const category = product.category || '';\n    if (Array.isArray(cartItems) && cartItems.length > 0) {\n      const cartCategories = cartItems.map((p) => p.category || '').filter(Boolean);\n      if (cartCategories.some((c) => category.toLowerCase().includes(c.toLowerCase()))) {\n        reasons.push('Hasonló a kosaradhoz');\n      }\n    } else if (recentlyViewed.length > 0) {\n      const viewedCats = recentlyViewed.map((p) => p.category || '').filter(Boolean);\n      if (viewedCats.some((c) => category.toLowerCase().includes(c.toLowerCase()))) {\n        reasons.push('Hasonló a korábban nézett termékeidhez');\n      }\n    }\n    if (topCategories.some((c) => category.toLowerCase().includes(c.toLowerCase()))) {\n      reasons.push(`Kedvelt kategória: ${category}`);\n    }\n    const categoryParts = category\n      .split('>')\n      .map((c) => c.trim().toLowerCase())\n      .filter(Boolean);\n    if (categoryParts.some((c) => (preferenceSignals.categories?.[c] || 0) > 0)) {\n      reasons.push('Tetszéseid alapján');\n    }\n    const textTokens = `${product.name || ''} ${product.category || ''}`\n      .toLowerCase()\n      .split(/[\\s,\\-\\/]+/)\n      .map((w) => w.trim())\n      .filter((w) => w.length > 3);\n    if (textTokens.some((t) => (preferenceSignals.keywords?.[t] || 0) > 0)) {\n      reasons.push('Kulcsszavas egyezés a kedveléseidből');\n    }\n    if (searchHistory.length > 0) {\n      const term = searchHistory.find((s) => {\n        const q = (s.query || '').toLowerCase();\n        const text = `${product.name || ''} ${product.category || ''} ${product.description || ''}`.toLowerCase();\n        return q && text.includes(q);\n      });\n      if (term?.query) reasons.push(`Korábbi keresés: “${term.query}”`);\n    }\n    if (styleDNA?.answers) {\n      const { space, room } = styleDNA.answers;\n      const text = `${product.name || ''} ${product.category || ''} ${product.description || ''}`.toLowerCase();\n      const styleKeywords = {\n        modern: ['modern', 'minimalista', 'letisztult'],\n        scandinavian: ['skandináv', 'natúr', 'világos', 'fehér'],\n        industrial: ['indusztriális', 'loft', 'fém', 'ipari'],\n        vintage: ['vintage', 'retro', 'antik'],\n        bohemian: ['bohém', 'színes', 'mintás'],\n      };\n      if (space && styleKeywords[space] && styleKeywords[space].some((kw) => text.includes(kw))) {\n        if (!recoTweaks.avoidStyles?.includes(space)) {\n          reasons.push(`Stílus illeszkedés: ${space}`);\n        }\n      }\n      const roomKeywords = {\n        living: ['kanapé', 'fotel', 'dohányzó', 'tv', 'nappali'],\n        bedroom: ['ágy', 'matrac', 'éjjeli', 'hálószoba'],\n        dining: ['étkező', 'asztal', 'szék'],\n        office: ['íróasztal', 'iroda', 'forgószék'],\n      };\n      if (room && roomKeywords[room] && roomKeywords[room].some((kw) => text.includes(kw))) {\n        if (!recoTweaks.avoidRooms?.includes(room)) {\n          reasons.push(`Szoba típusa: ${room}`);\n        }\n      }\n    }\n    return reasons.slice(0, 2);\n  };\n\n  useEffect(() => {\n    trackABEvent('similar-cta', 'impression');\n  }, []);\n\n  const styleFilters = [\n    { id: 'modern', label: 'Modern', keywords: ['modern', 'minimalista', 'letisztult'] },\n    { id: 'scandinavian', label: 'Skandináv', keywords: ['skandináv', 'natúr', 'világos', 'fehér'] },\n    { id: 'industrial', label: 'Indusztriális', keywords: ['indusztriális', 'loft', 'fém', 'ipari'] },\n    { id: 'vintage', label: 'Vintage', keywords: ['vintage', 'retro', 'antik'] },\n    { id: 'bohemian', label: 'Bohém', keywords: ['bohém', 'színes', 'mintás'] },\n  ];\n\n  const roomFilters = [\n    { id: 'living', label: 'Nappali', keywords: ['kanapé', 'fotel', 'dohányzó', 'tv', 'nappali'] },\n    { id: 'bedroom', label: 'Hálószoba', keywords: ['ágy', 'matrac', 'éjjeli', 'hálószoba'] },\n    { id: 'dining', label: 'Étkező', keywords: ['étkező', 'asztal', 'szék'] },\n    { id: 'office', label: 'Iroda', keywords: ['íróasztal', 'iroda', 'forgószék'] },\n  ];\n\n  const focusCounts = useMemo(() => {\n    const counts = {\n      categories: new Map(),\n      styles: new Map(),\n      rooms: new Map()\n    };\n    currentProductsRaw.forEach((p) => {\n      const text = `${p.name || ''} ${p.category || ''} ${p.description || ''}`.toLowerCase();\n      fallbackCategories.forEach((cat) => {\n        if ((p.category || '').toLowerCase().includes(cat.toLowerCase())) {\n          counts.categories.set(cat, (counts.categories.get(cat) || 0) + 1);\n        }\n      });\n      styleFilters.forEach((style) => {\n        if (style.keywords?.some((kw) => text.includes(kw))) {\n          counts.styles.set(style.id, (counts.styles.get(style.id) || 0) + 1);\n        }\n      });\n      roomFilters.forEach((room) => {\n        if (room.keywords?.some((kw) => text.includes(kw))) {\n          counts.rooms.set(room.id, (counts.rooms.get(room.id) || 0) + 1);\n        }\n      });\n    });\n    return counts;\n  }, [currentProductsRaw, fallbackCategories, styleFilters, roomFilters]);\n\n  const toggleFilter = (filter) => {\n    setFocusFilters((prev) => {\n      const exists = prev.find((f) => f.type === filter.type && f.id === filter.id);\n      if (exists) return prev.filter((f) => !(f.type === filter.type && f.id === filter.id));\n      const next = [...prev, filter];\n      return next.length > 3 ? next.slice(next.length - 3) : next;\n    });\n  };\n\n  // Ha nincs elég adat, ne jelenjen meg\n  if (currentProducts.length < 2 && forYouProducts.length < 2) {\n    return null;\n  }\n\n  return (\n    <section\n      className=\"section-shell section-world section-world--personal relative py-10 sm:py-14 lg:py-20 overflow-hidden\"\n      aria-label=\"Személyre szabott ajánlások\"\n      role=\"region\"\n      data-section=\"personalized\"\n    >\n      <div className=\"absolute -top-20 -right-16 w-72 h-72 bg-primary-200/30 blur-3xl rounded-full\" aria-hidden />\n      <div className=\"absolute -bottom-24 -left-16 w-80 h-80 bg-secondary-200/30 blur-3xl rounded-full\" aria-hidden />\n      <div className=\"w-full max-w-[2000px] mx-auto px-0 lg:px-10 xl:px-16\">\n        <div className=\"section-frame\">\n          <SectionHeader\n            id=\"personalized-heading\"\n            title=\"Személyre szabva neked\"\n            subtitle={styleDNA?.styleDNA ? styleDNA.styleDNA.split('.')[0] : 'AI ajánlások a böngészésed alapján'}\n            Icon={Sparkles}\n            accentClass=\"from-primary-500 to-secondary-700\"\n            eyebrow=\"Neked szól\"\n            badge={styleDNA?.styleDNA ? 'Style DNA aktív' : 'AI ajánlás'}\n            contextLabel={contextLabel}\n            prominent\n            className=\"border border-primary-100 shadow-sm section-header-hero section-header-hero--personal\"\n            meta={`Megjelenítve: ${Math.min(visibleProducts.length, currentProducts.length)} / ${currentProducts.length} termék`}\n            helpText=\"Csak készleten lévő termékek\"\n            actions={\n              <div className=\"flex items-center gap-2 flex-wrap\">\n                <div className=\"inline-flex items-center rounded-full bg-white border border-gray-100 shadow-sm p-1\">\n                {[24, 36, 48].map((size) => (\n                    <button\n                      key={size}\n                      onClick={() => setViewSize(size)}\n                      className={`px-3 py-1.5 rounded-full text-xs font-semibold transition-colors min-h-[36px] ${\n                        viewSize === size\n                          ? 'bg-primary-500 text-white'\n                          : 'text-gray-600 hover:bg-gray-100'\n                      }`}\n                    >\n                      {size} db\n                    </button>\n                  ))}\n                </div>\n                <button\n                  onClick={() => {\n                    trackABEvent('similar-cta', 'click');\n                    if (abVariant === 'A' && fallbackCategories.length > 0) {\n                      setFocusFilters(fallbackCategories.slice(0, 2).map((cat) => ({ id: cat, type: 'category', value: cat })));\n                    }\n                    setRefreshKey((v) => v + 1);\n                  }}\n                  className=\"inline-flex items-center gap-2 px-3 py-2 rounded-lg text-primary-700 bg-primary-50 border border-primary-100 hover:bg-primary-100 transition-colors text-sm font-semibold min-h-[44px]\"\n                >\n                  <RefreshCw className=\"w-4 h-4\" />\n                  {refreshKey % 2 === 0 ? 'Hasonlókat kérek' : 'Frissítem'}\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => setShowWhyPanel((v) => !v)}\n                  className=\"inline-flex items-center gap-2 px-3 py-2 rounded-lg text-gray-600 bg-white border border-gray-200 hover:bg-gray-50 transition-colors text-sm font-semibold min-h-[44px]\"\n                >\n                  <SlidersHorizontal className=\"w-4 h-4\" />\n                  Miért ezt?\n                </button>\n              </div>\n            }\n          />\n        \n        {styleDNA?.styleDNA && (\n          <div className=\"mb-4 inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-white border border-primary-100 text-primary-700 text-xs font-semibold shadow-sm\">\n            <Info className=\"w-3.5 h-3.5\" />\n            Style DNA aktív – személyre szabott ajánlások\n          </div>\n        )}\n\n        {showWhyPanel && (\n          <div className=\"mb-6 rounded-2xl border border-gray-200 bg-white p-4 sm:p-5 shadow-sm\">\n            <div className=\"flex flex-wrap items-center gap-3 mb-3\">\n              <span className=\"text-sm font-bold text-gray-900\">Miért ezeket látod?</span>\n              <span className=\"text-xs text-gray-500\">Kattints a finomhangoláshoz</span>\n            </div>\n            <div className=\"flex flex-wrap gap-2 mb-3\">\n              {searchHistory.slice(0, 4).map((s) => (\n                <span key={s.query} className=\"px-2.5 py-1 rounded-full bg-gray-100 text-xs text-gray-600\">\n                  Keresés: “{s.query}”\n                </span>\n              ))}\n              {fallbackCategories.slice(0, 4).map((cat) => (\n                <span key={cat} className=\"px-2.5 py-1 rounded-full bg-gray-100 text-xs text-gray-600\">\n                  Kedvelt: {cat}\n                </span>\n              ))}\n            </div>\n            <div className=\"flex flex-wrap items-center gap-2 mb-2\">\n              <span className=\"text-xs text-gray-500 mr-1\">Kevesebb stílus:</span>\n              {styleFilters.map((style) => (\n                <button\n                  key={style.id}\n                  type=\"button\"\n                  onClick={() => {\n                    const next = recoTweaks.avoidStyles?.includes(style.id)\n                      ? recoTweaks.avoidStyles.filter((s) => s !== style.id)\n                      : [...(recoTweaks.avoidStyles || []), style.id];\n                    const updated = setRecommendationTweaks({ avoidStyles: next });\n                    setRecoTweaks(updated);\n                    setRefreshKey((v) => v + 1);\n                  }}\n                  className={`px-3 py-1.5 rounded-full text-xs font-semibold border transition-colors ${\n                    recoTweaks.avoidStyles?.includes(style.id)\n                      ? 'bg-gray-900 text-white border-gray-900'\n                      : 'bg-white text-gray-600 border-gray-200 hover:bg-gray-50'\n                  }`}\n                >\n                  {style.label}\n                </button>\n              ))}\n            </div>\n            <div className=\"flex flex-wrap items-center gap-2\">\n              <span className=\"text-xs text-gray-500 mr-1\">Kevesebb szoba:</span>\n              {roomFilters.map((room) => (\n                <button\n                  key={room.id}\n                  type=\"button\"\n                  onClick={() => {\n                    const next = recoTweaks.avoidRooms?.includes(room.id)\n                      ? recoTweaks.avoidRooms.filter((r) => r !== room.id)\n                      : [...(recoTweaks.avoidRooms || []), room.id];\n                    const updated = setRecommendationTweaks({ avoidRooms: next });\n                    setRecoTweaks(updated);\n                    setRefreshKey((v) => v + 1);\n                  }}\n                  className={`px-3 py-1.5 rounded-full text-xs font-semibold border transition-colors ${\n                    recoTweaks.avoidRooms?.includes(room.id)\n                      ? 'bg-gray-900 text-white border-gray-900'\n                      : 'bg-white text-gray-600 border-gray-200 hover:bg-gray-50'\n                  }`}\n                >\n                  {room.label}\n                </button>\n              ))}\n              <button\n                type=\"button\"\n                onClick={() => {\n                  const updated = resetRecommendationTweaks();\n                  setRecoTweaks(updated);\n                  setRefreshKey((v) => v + 1);\n                }}\n                className=\"px-3 py-1.5 rounded-full text-xs font-semibold border border-gray-200 text-gray-600 hover:bg-gray-50\"\n              >\n                Reset\n              </button>\n            </div>\n          </div>\n        )}\n\n        {/* Tabs */}\n        <div className=\"flex gap-2 mb-6 overflow-x-auto pb-2 scrollbar-hide\">\n          {tabs.map((tab) => {\n            const Icon = tab.icon;\n            const isActive = activeTab === tab.id;\n            const count = tab.products?.length || 0;\n            \n            if (count === 0 && tab.id !== 'foryou') return null;\n            \n            return (\n              <button\n                key={tab.id}\n                onClick={() => setActiveTab(tab.id)}\n                className={`\n                  flex items-center gap-2 px-4 py-2.5 rounded-full whitespace-nowrap transition-all border\n                  ${isActive \n                    ? 'bg-primary-500 text-white shadow-lg border-primary-500' \n                    : 'bg-white text-gray-700 hover:bg-gray-100 shadow border-gray-100'\n                  }\n                `}\n              >\n                <Icon className={`w-4 h-4 ${isActive ? 'text-white' : 'text-primary-500'}`} />\n                <span className=\"font-medium text-sm\">{tab.label}</span>\n                {count > 0 && (\n                  <span className={`\n                    text-xs px-1.5 py-0.5 rounded-full\n                    ${isActive ? 'bg-white/20 text-white' : 'bg-primary-100 text-primary-600'}\n                  `}>\n                    {count}\n                  </span>\n                )}\n              </button>\n            );\n          })}\n        </div>\n\n        {fallbackCategories.length > 0 && (\n          <div className=\"flex flex-wrap items-center gap-2 mb-6\">\n            <span className=\"text-xs text-gray-500 mr-1\">Fókusz:</span>\n            <button\n              type=\"button\"\n              onClick={() => setFocusFilters([])}\n              className={`px-3 py-1.5 rounded-full text-xs font-semibold border transition-colors ${\n                focusFilters.length === 0 ? 'bg-gray-900 text-white border-gray-900' : 'bg-white text-gray-600 border-gray-100 hover:bg-gray-50'\n              }`}\n            >\n              Összes ({currentProductsRaw.length})\n            </button>\n            {fallbackCategories.map((cat) => (\n              <button\n                key={cat}\n                type=\"button\"\n                onClick={() => toggleFilter({ id: cat, type: 'category', value: cat })}\n                className={`px-3 py-1.5 rounded-full text-xs font-semibold border transition-colors ${\n                  focusFilters.some((f) => f.type === 'category' && f.id === cat)\n                    ? 'bg-primary-500 text-white border-primary-500'\n                    : 'bg-white text-gray-600 border-gray-100 hover:bg-gray-50'\n                }`}\n              >\n                {cat} ({focusCounts.categories.get(cat) || 0})\n              </button>\n            ))}\n            {styleFilters.map((style) => (\n              <button\n                key={style.id}\n                type=\"button\"\n                onClick={() => toggleFilter({ id: style.id, type: 'style', keywords: style.keywords })}\n                className={`px-3 py-1.5 rounded-full text-xs font-semibold border transition-colors ${\n                  focusFilters.some((f) => f.type === 'style' && f.id === style.id)\n                    ? 'bg-secondary-600 text-white border-secondary-600'\n                    : 'bg-white text-gray-600 border-gray-100 hover:bg-gray-50'\n                }`}\n              >\n                {style.label} ({focusCounts.styles.get(style.id) || 0})\n              </button>\n            ))}\n            {roomFilters.map((room) => (\n              <button\n                key={room.id}\n                type=\"button\"\n                onClick={() => toggleFilter({ id: room.id, type: 'room', keywords: room.keywords })}\n                className={`px-3 py-1.5 rounded-full text-xs font-semibold border transition-colors ${\n                  focusFilters.some((f) => f.type === 'room' && f.id === room.id)\n                    ? 'bg-emerald-600 text-white border-emerald-600'\n                    : 'bg-white text-gray-600 border-gray-100 hover:bg-gray-50'\n                }`}\n              >\n                {room.label} ({focusCounts.rooms.get(room.id) || 0})\n              </button>\n            ))}\n            {focusFilters.length > 0 && (\n              <div className=\"ml-auto flex flex-wrap items-center gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={() => setFocusOrder('match')}\n                  className={`px-3 py-1.5 rounded-full text-xs font-semibold border transition-colors ${\n                    focusOrder === 'match'\n                      ? 'bg-primary-600 text-white border-primary-600'\n                      : 'bg-white text-gray-600 border-gray-200 hover:bg-gray-50'\n                  }`}\n                >\n                  Legjobb illeszkedés\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => setFocusOrder('mix')}\n                  className={`px-3 py-1.5 rounded-full text-xs font-semibold border transition-colors ${\n                    focusOrder === 'mix'\n                      ? 'bg-gray-900 text-white border-gray-900'\n                      : 'bg-white text-gray-600 border-gray-200 hover:bg-gray-50'\n                  }`}\n                >\n                  Változatos\n                </button>\n              </div>\n            )}\n          </div>\n        )}\n\n        {currentProducts.length === 0 ? (\n          <div className=\"mt-6 rounded-2xl border border-gray-200 bg-white p-6 text-center\">\n            <p className=\"text-sm font-semibold text-gray-700\">Nincs találat a fókusz alapján</p>\n            <p className=\"text-xs text-gray-500 mt-1\">Próbálj más fókuszt, vagy állítsd vissza az összesre.</p>\n            <button\n              type=\"button\"\n              onClick={() => setFocusFilters([])}\n              className=\"mt-3 inline-flex items-center justify-center px-4 py-2 rounded-full bg-gray-900 text-white text-xs font-semibold\"\n            >\n              Fókusz törlése\n            </button>\n          </div>\n        ) : (\n          <ProductCarousel className=\"mt-2\">\n            {visibleProducts.map((product, index) => {\n              const stockLevel = getStockLevel(product);\n              const highlightBadge = stockLevel !== null && stockLevel <= 3 ? `Utolsó ${stockLevel} db` : '';\n              return (\n                <EnhancedProductCard\n                  key={product.id}\n                  product={product}\n                  onToggleWishlist={onToggleWishlist}\n                  isWishlisted={wishlist.includes(product.id)}\n                  onQuickView={onProductClick}\n                  onAddToCart={onAddToCart}\n                  index={index}\n                  highlightBadge={highlightBadge}\n                  recommendationReasons={buildRecommendationReasons(product)}\n                  sectionId={`personalized-${activeTab}`}\n                  showFeedback\n                  size=\"compact\"\n                  tone=\"personal\"\n                />\n              );\n            })}\n          </ProductCarousel>\n        )}\n\n        {/* Empty state for recent */}\n        {activeTab === 'recent' && currentProducts.length === 0 && (\n          <div className=\"text-center py-12 bg-white rounded-2xl shadow-inner\">\n            <Clock className=\"w-12 h-12 text-gray-300 mx-auto mb-3\" />\n            <p className=\"text-gray-500\">Még nem néztél meg termékeket</p>\n            <p className=\"text-gray-400 text-sm\">Böngéssz a kínálatban!</p>\n          </div>\n        )}\n        </div>\n      </div>\n    </section>\n  );\n};\n\nexport default PersonalizedSection;\n"],"names":["SectionHeader","title","id","subtitle","Icon","accentClass","badge","eyebrow","helpText","meta","contextLabel","actions","prominent","className","jsxs","jsx","PersonalizedSection","products","onProductClick","onToggleWishlist","wishlist","onAddToCart","cartItems","activeTab","setActiveTab","useState","refreshKey","setRefreshKey","viewSize","setViewSize","focusOrder","setFocusOrder","focusFilters","setFocusFilters","showWhyPanel","setShowWhyPanel","recoTweaks","setRecoTweaks","getRecommendationTweaks","abVariant","useMemo","getABVariant","recentlyViewed","getViewedProducts","p","styleDNA","getStyleDNA","topCategories","getTopCategories","searchHistory","getSearchHistory","preferenceSignals","getPreferenceSignals","useEffect","trackSectionEvent","forYouProducts","getPersonalizedRecommendations","trendingProducts","cartBasedProducts","base","merged","getSimilarProducts","item","tabs","Sparkles","Clock","TrendingUp","ShoppingCart","currentProductsRaw","_a","t","getFocusScore","useCallback","product","text","score","f","kw","_b","currentProducts","filtered","a","b","visibleProducts","fallbackCategories","counts","name","buildRecommendationReasons","reasons","category","c","w","term","s","q","space","room","styleKeywords","roomKeywords","trackABEvent","styleFilters","roomFilters","focusCounts","cat","style","toggleFilter","filter","prev","next","size","v","RefreshCw","SlidersHorizontal","Info","updated","setRecommendationTweaks","r","resetRecommendationTweaks","tab","isActive","count","ProductCarousel","index","stockLevel","getStockLevel","highlightBadge","EnhancedProductCard"],"mappings":"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"}